search_rag:
  description: >
    Busque informações no RAG do Asimov sobre as entrevistas Consumer Hours processadas.
    
    Use a ferramenta rag_search_tool para fazer perguntas sobre:
    - Marcas mencionadas nas entrevistas relacionadas ao tema "{topic}"
    - Temas principais discutidos relacionados ao tema "{topic}"
    - Sentimentos expressos sobre "{topic}"
    - Momentos de consumo mencionados relacionados a "{topic}"
    - Evidências e citações literais sobre "{topic}"
    - Padrões e tendências identificáveis sobre "{topic}"
    - Ausências e lacunas de informação sobre "{topic}"
    
    Faça múltiplas consultas ao RAG para consolidar informações sobre o tema "{topic}".
    Seja exaustivo na busca para garantir que todos os dados relevantes sejam coletados.
    
    IMPORTANTE: Todas as perguntas devem ser direcionadas especificamente para responder sobre "{topic}".
    Não faça perguntas genéricas que não estejam relacionadas ao tema.
    
    CRÍTICO - PRESERVAÇÃO DE TRECHOS REAIS:
    A ferramenta rag_search_tool retorna:
    1. Uma resposta do modelo
    2. SNIPPETS (trechos EXATOS das entrevistas) que foram usados como contexto
    
    Você DEVE:
    - Incluir TODOS os snippets (trechos reais) retornados em cada busca
    - NUNCA parafrasear ou resumir os snippets - preserve o texto EXATO
    - NUNCA referenciar snippets por número (ex: "Snippet 1", "Snippet 2")
    - Use diretamente o CONTEÚDO do snippet (a citação real da entrevista)
    - Associar cada citação (conteúdo do snippet) à informação que ela suporta
    - No seu resumo consolidado, inclua os trechos literais das entrevistas (o texto real, não referências)
    
    Use os seguintes parâmetros para a ferramenta:
    - model: {model}
    - temperature: {temperature}
    - max_tokens: {max_tokens}
    
    Consolide todas as respostas do RAG em um resumo estruturado que destaque:
    - O que há evidência suficiente para afirmar sobre "{topic}"
    - O que não fica claro ou está ausente sobre "{topic}"
    - Dados parciais que permitem suposições sobre "{topic}"
    - Para cada afirmação, inclua o trecho EXATO da entrevista que a suporta
  expected_output: >
    Um resumo estruturado contendo todas as respostas do RAG especificamente sobre "{topic}":
    - Marcas mencionadas em relação a "{topic}" (com trechos EXATOS das entrevistas)
    - Temas relacionados a "{topic}" (com trechos EXATOS das entrevistas)
    - Sentimentos expressos sobre "{topic}" (com trechos EXATOS das entrevistas)
    - Momentos de consumo relacionados a "{topic}" (com trechos EXATOS das entrevistas)
    - Evidências literais sobre "{topic}" (trechos EXATOS, nunca paráfrases)
    - Padrões identificados sobre "{topic}" (com trechos EXATOS que os demonstram)
    - Lacunas e ausências de informação sobre "{topic}"
    - Classificação do que pode ser afirmado vs. o que não fica claro sobre "{topic}"
    - Para cada item acima, o trecho da entrevista que contém a informação
  agent: rag_searcher

treat:
  description: >
    Trate e estruture os dados retornados pelo rag_searcher usando a ferramenta rag_treatment_tool.
    
    Use EXCLUSIVAMENTE o resultado da task anterior (search_rag) que está disponível no contexto.
    NÃO invente ou suponha dados que não estejam no resultado do search_rag.
    
    Passe esse resultado completo para a ferramenta rag_treatment_tool com:
    - rag_search_result: o resultado completo da task search_rag (disponível no contexto)
    - topic: {topic}
    
    O tratamento deve:
    - Consolidar informações de múltiplas respostas do RAG
    - Organizar por temas, marcas, sentimentos, momentos
    - Estruturar evidências literais EXATAS (preservar texto real, nunca parafrasear)
    - PRESERVAR os snippets (trechos reais das entrevistas) retornados pelo RAG
    - Associar cada afirmação ao snippet exato que a suporta
    - Classificar informações em três categorias:
      1. DÁ PARA AFIRMAR: evidências claras e suficientes com citações literais EXATAS dos snippets
      2. NÃO FICA CLARO: ausência de dados ou informações contraditórias
      3. ALGUMAS SUPOSIÇÕES: inferências baseadas em dados parciais (marcar claramente como suposição)
    - Identificar implicações e significados ("ISSO SIGNIFICA QUE...")
    - Preparar dados para o relatório executivo
    
    CRÍTICO - PRESERVAÇÃO DE SNIPPETS:
    A ferramenta rag_treatment_tool extrai os snippets (trechos reais) do resultado do RAG.
    Você DEVE garantir que:
    - Todos os snippets sejam preservados no resultado tratado
    - Cada snippet seja associado à informação que ele suporta
    - Os snippets sejam estruturados de forma que o writer possa acessá-los facilmente
    - NUNCA parafrasear snippets - use o texto exato retornado
    - NUNCA referenciar snippets por número - use o CONTEÚDO (citação real) diretamente
    - Estruture as citações pelo seu conteúdo textual, não por referências numéricas
    
    IMPORTANTE: Se não houver dados suficientes sobre algum aspecto do tema, declare explicitamente a ausência.
    Não crie informações que não estejam no resultado do search_rag.
    
    Retorne dados estruturados e organizados que serão usados pelo writer.
  expected_output: >
    Dados tratados e estruturados contendo:
    - Resumo consolidado por tema
    - Lista de marcas com evidências (cada uma com o snippet exato que a suporta)
    - Distribuição de sentimentos (com snippets exatos)
    - Momentos de consumo organizados (com snippets exatos)
    - Evidências literais EXATAS por categoria (snippets preservados integralmente)
    - Classificação: DÁ PARA AFIRMAR / NÃO FICA CLARO / ALGUMAS SUPOSIÇÕES
    - Implicações e significados identificados
    - Declarações explícitas sobre ausência de dados quando aplicável
    - Estrutura de snippets: cada afirmação deve ter associado o trecho exato da entrevista
  agent: treater

write_report:
  description: >
    Criar um RELATÓRIO EXECUTIVO COMPLETO sobre o tema:

    "{topic}"

    utilizando EXCLUSIVAMENTE os dados tratados do treater.

    Use os dados consolidados do treated_data que contém informações estruturadas
    do RAG sobre as entrevistas Consumer Hours. Os dados vêm do resultado do search_rag.

    CRÍTICO - USO DE SNIPPETS EXATOS:
    O treated_data contém snippets (trechos EXATOS das entrevistas) que foram extraídos pelo RAG.
    Você DEVE:
    - Usar os snippets EXATOS nas citações, nunca parafrasear ou resumir
    - Para cada afirmação na seção "DÁ PARA AFIRMAR", inclua o snippet exato que a suporta
    - Preservar a linguagem original do entrevistado
    - Se um snippet estiver no treated_data, use-o literalmente nas citações
    - NUNCA referenciar snippets por número (ex: "conforme Snippet 1", "segundo Snippet 2")
    - Use diretamente o CONTEÚDO da citação (o trecho real da entrevista) nas suas afirmações
    - Formato: apresente a citação diretamente, não como referência a um snippet numerado

    O relatório DEVE:
    - Responder diretamente ao tema "{topic}"
    - Ser baseado APENAS em evidências das entrevistas (dados do search_rag)
    - Incluir citações literais EXATAS (trechos reais das entrevistas, não paráfrases)
    - Declarar explicitamente quando não houver dados suficientes
    - Ser escrito em português (PT-BR)
    - Usar linguagem executiva, clara e precisa
    - Distinguir claramente entre afirmações, suposições e ausências

    ESTRUTURA OBRIGATÓRIA:
    1. Título (refletindo o tema "{topic}")
    2. Resumo Executivo (resposta direta ao tema, síntese de padrões)
    3. Introdução e Contexto da Pesquisa
    4. Metodologia (número de entrevistas, estrutura dos dados)
    5. O QUE DÁ PARA AFIRMAR (com evidências literais e citações EXATAS dos snippets)
    6. O QUE NÃO FICA CLARO (ausências, contradições, dados insuficientes)
    7. ALGUMAS SUPOSIÇÕES (inferências baseadas em dados parciais - marcar claramente)
    8. ISSO SIGNIFICA QUE... (implicações, significados e conexões identificadas)
    9. Principais Descobertas das Entrevistas (com evidência literal EXATA dos snippets)
    10. Análise Detalhada dos Padrões
    11. Temas, Sentimentos, Marcas e Momentos
    12. Limitações dos Dados
    13. Oportunidades ou Tensões Explicitadas

    REGRAS DE EVIDÊNCIA:
    - Toda afirmação na seção "DÁ PARA AFIRMAR" deve ter pelo menos uma citação literal EXATA de um snippet
    - Use o texto EXATO do snippet, nunca parafraseie ou resuma
    - NUNCA referencie snippets por número - use diretamente o CONTEÚDO da citação
    - Apresente a citação como trecho real da entrevista, não como referência a "Snippet X"
    - Se faltar evidência, declare explicitamente na seção "NÃO FICA CLARO"
    - Suposições devem ser claramente marcadas como tal na seção "ALGUMAS SUPOSIÇÕES"
    - NÃO invente dados que não estejam no treated_data (que vem do search_rag)
    - Se não houver dados sobre algum aspecto, declare: "Não há dados suficientes nas entrevistas para..."
    - Formato de citação: use aspas e apresente o trecho literal diretamente: "citação exata do snippet"
  expected_output: >
    Relatório executivo em Markdown, rigoroso e orientado à resposta direta do tema "{topic}",
    contendo obrigatoriamente todas as seções listadas acima, com clara distinção entre
    o que pode ser afirmado, o que não fica claro, suposições e implicações.
    Todas as citações devem ser trechos EXATOS dos snippets, nunca paráfrases.
  agent: writer